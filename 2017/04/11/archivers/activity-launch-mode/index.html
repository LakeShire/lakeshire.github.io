<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=PT Mono:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Android,Activity," />





  <link rel="alternate" href="/atom.xml" title="湖畔镇" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="本文介绍一些与Activity相关的小知识">
<meta name="keywords" content="Android,Activity">
<meta property="og:type" content="article">
<meta property="og:title" content="Activity相关">
<meta property="og:url" content="http://lakeshire.github.io/2017/04/11//archivers/activity-launch-mode/index.html">
<meta property="og:site_name" content="湖畔镇">
<meta property="og:description" content="本文介绍一些与Activity相关的小知识">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-11-28T03:11:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Activity相关">
<meta name="twitter:description" content="本文介绍一些与Activity相关的小知识">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://lakeshire.github.io/2017/04/11//archivers/activity-launch-mode/"/>





  <title> Activity相关 | 湖畔镇 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">湖畔镇</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description"></h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://lakeshire.github.io/2017/04/11/archivers/activity-launch-mode/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘晗">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="湖畔镇">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="湖畔镇" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                Activity相关
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-11T17:00:00+08:00">
                2017-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          
 
        


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文介绍一些与Activity相关的小知识</p>
<a id="more"></a>
<h2 id="启动模式"><a href="#启动模式" class="headerlink" title="启动模式"></a>启动模式</h2><p><code>Activity</code>可以设置<code>android:launchMode</code>指定启动模式</p>
<ul>
<li><p><code>standard</code><br>标准</p>
</li>
<li><p><code>singleTop</code><br>唯一栈顶，启动的Activity如果在栈顶，将不再新建，而是调用原Activity的<code>onNewIntent()</code><br>比如点击搜索按钮进入搜索结果页面，一般而言还是会有搜索框可以再次搜索，如果反复生成新搜索页面，回退的时候非常麻烦而且很怪异，这个时候适合用这个</p>
</li>
<li><p><code>singleTask</code><br>如果栈内已经有一个标记为<code>singleTask</code>的Activity A，再次启动一个这样的Activity时将不会新建，而是会残忍的销毁A之上的所有Activity，使A显示在栈顶，并调用它的<code>onNewIntent()</code><br>文档里提到然而并不是这样，如果想达到这样的效果即新开一个Task，这个Activity作为根，你需要配置清单的<code>android:taskAffinity</code>属性为空</p>
</li>
</ul>
<blockquote>
<p>The system creates a new task and instantiates the activity at the root of the new task</p>
</blockquote>
<ul>
<li><code>singleInstance</code><br>栈内只有这么一个Activity，再次启动一个这样的Acitivity会启动一个新的Task</li>
</ul>
<h2 id="标志位"><a href="#标志位" class="headerlink" title="标志位"></a>标志位</h2><p>比较常用的有下面这些</p>
<ul>
<li><p><code>FLAG_ACTIVITY_SINGLE_TOP</code><br>唯一栈顶，启动的Activity如果在栈顶，将不再新建，而是调用原Activity的<code>onNewIntent()</code></p>
</li>
<li><p><code>FLAG_ACTIVITY_NEW_TASK</code><br>启动一个新的Task，通常用于表现启动器行为，提供用户一组可以做的事，然后运行在完全独立的Task里</p>
</li>
<li><p><code>FLAG_ACTIVITY_MULTIPLE_TASK</code><br>用来启动一个新的Task，通常与<code>FLAG_ACTIVITY_NEW_TASK</code>或<code>FLAG_ACTIVITY_NEW_DOCUMENT</code>一起使用（不一起使用该标记会被忽略），因为单独使用这些标记时，如果能在现存的Task里找到匹配的，就不会再新建，加上这个标记则会跳过搜索匹配Task的过程，无条件的创建一个新的Task</p>
</li>
<li><p><code>FLAG_ACTIVITY_CLEAR_TOP</code><br>可以和<code>FLAG_ACTIVITY_NEW_TASK</code>很好的搭配，用来启动一个Task的根Activity，将把那个Task当前正在运行的任何实例都调到前台，然后清除到根，在从通知里启动Activity这种场景尤其有用</p>
</li>
<li><p><code>FLAG_ACTIVITY_REORDER_TO_FRONT</code><br>如果已经运行，就调到栈顶，如果<code>FLAG_ACTIVITY_CLEAR_TOP</code>也被设置了会被忽略</p>
</li>
<li><p><code>FLAG_ACTIVITY_CLEAR_TASK</code><br>清空Task，Activity成为根</p>
</li>
</ul>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p>Activity有三种重要状态：</p>
<ul>
<li><code>resumed</code><br>Activity在前台，拥有用户焦点</li>
<li><code>paused</code><br>别的Activity在前台并且拥有焦点，但是这个Activity仍然可见，内存中保存有Activity对象，维持着所有状态，保持附着于WindowManager，在极度低内存时可能被销毁</li>
<li><code>stopped</code><br>完全被其他Activity覆盖，处于后台不可见，内存中保存有Activity对象，维持着所有状态，但是未附着于WindowManager，当其他地方需要内存时可能被销毁</li>
</ul>
<p>当Activity是<code>paused</code>或<code>stopped</code>时，系统可能调用<code>finish()</code>或直接杀死进程来回收内存，当Activity再次被打开时，必须被重新创建</p>
<p>生命周期</p>
<ul>
<li>全部阶段<br>从<code>onCreate()</code>到<code>onDestroy()</code>，在前者初始化，在后者释放所有资源，比如停止后台下载线程</li>
<li>可见阶段<br>从<code>onStart()</code>到<code>onStop()</code>，可以在前者注册<code>BroadcastReceiver</code>监视UI变化，在后者注销</li>
<li>前台阶段<br>从<code>onResume()</code>到<code>onPause()</code>，获得焦点用户可交互，可能频繁切换，所以其中的代码需要轻量，<code>onPause()</code>是Activity可能被销毁之前调用的最后方法，所以要在这里做关键数据保存</li>
</ul>
<p>假设A启动B，执行顺序是A.onPause() -&gt; B.onCreate() -&gt; B.onStart() -&gt; B.onResume() -&gt; A.onStop()，所以如果A需要写入数据供B读取，应该发生在<code>onPause()</code>中</p>
<h2 id="配置变化"><a href="#配置变化" class="headerlink" title="配置变化"></a>配置变化</h2><p>如果配置变化，UI都需要更新，Activity有特殊的支持处理配置变化<br>除非特别指定，配置变化将会导致当前Activity被销毁，如果Activity当前可见，之后会重新实例化，使用<code>savedInstanceState</code>，这是之前实例通过<code>onSaveInstanceState()</code>保存的</p>
<p>某些特殊情况，你可能想跳过重建，通过清单里的<code>android:configChanges</code>配置，对于你要处理的任意配置变化类型，将会调用<code>onConfigurationChanged()</code>而不是重启，如果一个配置变化你不处理，仍然会重建而且这个函数不会被调用</p>
<p>要做以下几点：</p>
<ol>
<li>添加权限<code>&lt;uses-permission android:name=&quot;android.permission.CHANGE_CONFIGURATION&quot; /&gt;</code></li>
<li>指定<code>android:configChanges</code>属性，用<code>|</code>连接多个变化项</li>
<li>重写<code>onConfigurationChanged()</code></li>
</ol>
<blockquote>
<p>从API13后转屏时<code>screenSize</code>也会改变，这时仅写<code>orientation</code>是不会生效的，而要写<code>orientation|srceenSize</code>，小于API13则不需要，此为一坑</p>
</blockquote>
<h2 id="保存状态"><a href="#保存状态" class="headerlink" title="保存状态"></a>保存状态</h2><p>Activity可能被销毁，重建时需要之前的信息，可以通过<code>onSaveInstanceState()</code>保存信息，在<code>onCreate()</code>或<code>onRestoreInstanceState()</code>中获得信息恢复</p>
<p><code>onSaveInstanceState()</code>是不保证被调用的，因为当用户主动关闭Activity时没有必要保存状态，如果系统调用这个方法，会在<code>onStop()</code>之前调用，可能在<code>onPause()</code>之前</p>
<p>然而即使你没有实现<code>onSaveInstanceState()</code>，一些Activity状态仍然被默认实现保存了，默认会调用所有视图的<code>onSaveInstanceState()</code>，保存所有视图的状态，几乎所有视图都实现了这个方法，所以能保存和恢复状态，不过你需要提供一个<code>android:id</code>，否则不会保存状态</p>
<p>重写这些方法的时候不要忘了调用父类方法</p>
<p><code>onSaveInstanceState()</code>不保证被调用，所以应该只用来保存UI状态，不要用它保存数据，这应该在<code>onPause()</code>中做</p>
<h2 id="进程生命周期"><a href="#进程生命周期" class="headerlink" title="进程生命周期"></a>进程生命周期</h2><p>同一个应用的所有组件都在同一个进程下，可以通过组件的<code>android:process</code>属性指定不同的进程，也可以指定<code>application</code>的这个属性为所有组件指定默认的进程</p>
<p>Android系统尽可能保持应用进程的运行，当内存很低时也会移除旧的进程，有五种进程状态，按重要程度排列：</p>
<ul>
<li><code>前台进程</code>   </li>
</ul>
<ol>
<li>进程中包含处于前台的正与用户交互的Activity</li>
<li>进程中包含与前台Activity绑定的Service</li>
<li>进程中包含调用了<code>startForeground()</code>方法的Service</li>
<li>进程中包含正在执行<code>onCreate()</code>, <code>onStart()</code>, 或<code>onDestroy()</code>方法的Service</li>
<li>进程中包含正在执行<code>onReceive()</code>方法的<code>BroadcastReceiver</code><br>系统中前台进程的数量很少, 前台进程几乎不会被杀死，只有当内存低到无法保证所有的前台进程同时运行时才会选择杀死某个前台进程（系统也差不多挂了）</li>
</ol>
<ul>
<li><code>可见进程</code>  </li>
</ul>
<ol>
<li>进程中包含未处于前台但仍然可见的Activity（调用了<code>onPause()</code>方法, 但没有调用<code>onStop()</code>方法），典型的情况是运行Activity时弹出对话框, 此时的Activity虽然不是前台Activity, 但其仍然可见</li>
<li>进程中包含与可见Activity绑定的Service</li>
</ol>
<ul>
<li><p><code>服务进程</code><br>包含已启动的Service</p>
</li>
<li><p><code>后台进程</code><br>不可见，暂停</p>
</li>
<li><p><code>空进程</code><br>不持有Activity和其他组件，当系统内存低时会被很快杀掉，空进程存在的唯一理由是为了缓存一些启动数据，以便下次可以更快的启动</p>
</li>
</ul>
<blockquote>
<p>由于服务进程的优先级高于后台进程，因此如果Activity需要执行耗时操作，最好还是启动一个Service来完成，当然在Activity中启动子线程完成耗时操作也可以，但是这样做的缺点在于，一旦Activity不再可见，Activity所在的进程成为后台进程，而内存不足时后台进程随时都有可能被系统杀死。基于同样的考虑，在BroadcastReceiver中也不应该执行耗时操作，而应该启动Service来完成(当然, BroadcastReceiver的生命周期过于短暂，也决定了不能在其中执行耗时操作)</p>
</blockquote>
<h2 id="有用的方法"><a href="#有用的方法" class="headerlink" title="有用的方法"></a>有用的方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFinishing</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>检查Activity是不是结束了，可能是你手动调用了<code>finish()</code>，也可能是其他地方请求结束<br>经常在<code>onPause()</code>中检查Acitivity只是暂停还是彻底结束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">moveTaskToBack</span> <span class="params">(<span class="keyword">boolean</span> nonRoot)</span></span></span><br></pre></td></tr></table></figure>
<p>把包含此Activity的Task移动到Activity栈的后面，Task内的Activity顺序不变，<code>nonRoot</code>是<code>true</code>对所有Activity有效，<code>false</code>只对根Activity有效</p>
<p>测试：比如A1-&gt;A2-&gt;A3，A3调用<code>moveTaskToBack()</code>，参数为<code>true</code>时”退出”应用，实际栈维持不变，再回到应用还是一样的，参数为<code>false</code>时在这个页面无效，只在A有效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">navigateUpTo</span> <span class="params">(Intent upIntent)</span></span></span><br></pre></td></tr></table></figure>
<p>类似目标Activity有<code>singleTask</code>的效果，在复杂导航的APP里可能有用<br>应该用于同Task里的向上操作，如果跨Task，参见<code>shouldUpRecreateTask()</code></p>
<p>测试：比如A1-&gt;A2-&gt;A3-&gt;A4，A4调用<code>navigateUpTo()</code>到A1，A2/A3/A4都会出栈，A1再按后退键就会退出应用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldUpRecreateTask</span> <span class="params">(Intent targetIntent)</span></span></span><br></pre></td></tr></table></figure>
<p>当向上导航时是否要重建Task</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> PendingIntent <span class="title">createPendingResult</span> <span class="params">(<span class="keyword">int</span> requestCode, Intent data, <span class="keyword">int</span> flags)</span></span></span><br></pre></td></tr></table></figure>
<p>创建<code>PendingIntent</code>，你能够传给其他组件，它们可以用来发送数据回来到<code>onActivityResult()</code>，可以是一次性的也可以是多次使用的</p>
<p>这个方法可以用来Activity与Service交互，也可以应用于跨Activity传递数据，比如A、B、C三个Activity，A打开B，B打开C，然后B自动关掉，A接收C的结果，就可以使用这种方式传递PendingIntent实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PendingIntent pendingResult = createPendingResult(<span class="number">100</span>, <span class="keyword">new</span> Intent(), <span class="number">0</span>);  </span><br><span class="line">Intent i = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, MyService.class);  </span><br><span class="line">i.putExtra(PENDING__RESULT, pendingResult);  </span><br><span class="line">startService(i);</span><br></pre></td></tr></table></figure>
<p>先启动一个service，PendingIntent也传过去</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PendingIntent pendingIntent = intent.getParcelableExtra(MainActivity.PENDING__RESULT);  </span><br><span class="line"><span class="keyword">try</span> &#123;  </span><br><span class="line">    pendingIntent.send(MyService.<span class="keyword">this</span>, <span class="number">101</span>, <span class="keyword">new</span> Intent().putExtra(<span class="string">"data"</span>, <span class="string">"some data"</span>));  </span><br><span class="line">&#125; <span class="keyword">catch</span> (CanceledException e) &#123;  </span><br><span class="line">    e.printStackTrace();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用<code>PendingIntent</code>的<code>send()</code>方法，发送结果给调用的Activity，让其<code>onActivityResult()</code>响应</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finishAffinity</span> <span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>可以关闭当前Activity所属的Activity栈中所有的Activity，如果所有Activity都保存在默认栈中，则使用该方法会直接退出程序</p>
<p>如果要回到程序的主界面，则可以在清单文件中将主界面的Activity设置为单独的栈保存，设置<code>android:taskAffinity=&quot;:[name]</code>“</p>
<h2 id="清空任务栈"><a href="#清空任务栈" class="headerlink" title="清空任务栈"></a>清空任务栈</h2><p>用户离开Task很长时间，系统清理Task里的除了根Activity以外的所有Activity，当用户回来，只有根Activity会恢复<br>有一些Activity属性可以用来改变这种行为</p>
<ul>
<li><code>alwaysRetainTaskState</code><br>如果根Activity的这个属性是<code>true</code>，则总是保留Activity</li>
<li><code>clearTaskOnLaunch</code><br>如果根<code>Activity</code>的这个属性是<code>true</code>，则总是清空Activity</li>
<li><code>finishOnTaskLaunch</code><br>类似<code>clearTaskOnLaunch</code>，但是不是对整个Task，而是对单个Activity</li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"># Android</a>
          
            <a href="/tags/Activity/" rel="tag"># Activity</a>
          
        </div>
      


    <div>
      
        

      
    </div>


    <footer class="post-footer">
         
      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/11/archivers/event-bus/" rel="next" title="EventBus总结">
                <i class="fa fa-chevron-left"></i> EventBus总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/15/archivers/gradle-plugin/" rel="prev" title="Gradle插件">
                Gradle插件 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-tencentweibo"><p>腾讯微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-renren"><p>人人网</p></li>
        <li class="-mob-share-kaixin"><p>开心网</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="http://f1.webshare.mob.com/code/mob-share.js?appkey=22ad92fd0e280"></script>
<!--MOB SHARE END-->     
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="刘晗" />
          <p class="site-author-name" itemprop="name">刘晗</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#启动模式"><span class="nav-number">1.</span> <span class="nav-text">启动模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标志位"><span class="nav-number">2.</span> <span class="nav-text">标志位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生命周期"><span class="nav-number">3.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置变化"><span class="nav-number">4.</span> <span class="nav-text">配置变化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#保存状态"><span class="nav-number">5.</span> <span class="nav-text">保存状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进程生命周期"><span class="nav-number">6.</span> <span class="nav-text">进程生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有用的方法"><span class="nav-number">7.</span> <span class="nav-text">有用的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#清空任务栈"><span class="nav-number">8.</span> <span class="nav-text">清空任务栈</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘晗</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>





        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  




  
  

  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


</body>
</html>
